좋은 코드에 대한 조언과 의견은 넘쳐난다.

하지만 이런 조언을 최대한 많이 받아들이고 그것을 종교처럼 아무런 비판 없이 따라도 될 만큼 단순한 경우는 거의 없다.

좋은 코드를 작성하기 위해서는 당면한 상황에 합리적인 판단력을 적용해야 하고, 어떤 특정한 행동 방식의 결과가 어떻게 될지 주의 깊게 생각해야 한다.


# Chapter 1 - 코드 품질

## 코드 품질이 중요한 이유


### 고품질의 코드

- 최초 요구 사항 -> 완전하게 충족
- 요구 사항 변화 -> 사소한 추가 작업 필요
- 오류 발생 시 -> 시스템이 복구되거나 부분적으로 작동
- 처음 접하는 상황 -> 명백히 예상되지 않은 상황도 처리
- 시스템 공격 -> 시스템은 안전한 상태이고 손상되지 않음

**고품질 코드는 일반적으로 좀 더 신뢰할 수 있고, 유지보수하기 쉬우며, 버그가 적은 소프트웨어를 생산한다.**


## 코드로부터 실제 서비스되는 환경에서 실행되는 소프트웨어가 되기까지의 과정

1. 개발자가 코드베이스의 로컬 복사본을 가지고 작업하면서 코드를 변경한다.
2. 작업이 끝나면 코드 검토를 위해 변경된 코드를 가지고 병합 요청을 한다.
3. 다른 개발자가 코드를 검토하고 변경을 제한할 수 있다.
4. 작성자와 검토자가 모두 동의하면 코드가 코드베이스에 병합된다.
5. 배포는 코드베이스를 가지고 주기적으로 일어난다. 얼마나 자주 배포되는지는 조직과 침마다 다를 수 있다.
6. 테스트에 실패하거나 코드가 컴파일되지 않으면 코드페이스에 병합되는 것을 막거나 코드가 배포되는 것을 막는다.


## 고품질의 코드가 이루고자 하는 네 가지 목표

고품질의 소프트웨어를 만들기 위해서는 소프트웨어가 잘 구축되어야 한다 -> 이것이 바로 코드 품질의 진정한 목적이다.


### 네가지 목표


#### 1. 작동해야 한다.

코드의 첫 번째 목표는 그것이 애초에 작성된 목적대로 동작해야 한다는 것이다.


#### 2. 작동이 멈춰서는 안 된다.

**코드 작동은 매우 일시적일 수 있다.**

- 코드는 다른 코드에 의존할 수 있는데, 그 코드가 수정되고 변경될 수 있다.

- 새로운 기능이 필요할 때 코드를 수정해야 할 수도 있다.

- 우리가 해결하여고 하는 문제는 시간이 지남에 따라 변경된다. 소비자 선호, 비즈니스 요구, 교려해야 할 기술 등이 바뀔 수 있다.

**현재는 잘 돌아가지만 미래에 이런 것 중 하나가 변경된 경우, 제대로 동작하지 않는다면 그 코드는 별로 유용한 코드가 아니다.**


#### 3. 변화하는 요구 사항에 적응해야 한다.

**코드나 소프트웨어가 시간이 지남에 따라 어떻게 변할지 완벽하고 정확하게 예측하는 것은 불가능하다!**

**하지만 어떻게 변할지 정확히 알지 못한다고 해서 변한다는 사실 자체를 완전히 무시해야 하는 것은 아니다.**

코드가 어떻게 적응햐여 할지 미리 정확히 알지 못해도, 적응성 높은 코드를 작성해야 한다.


#### 4. 이미 존재하는 기능을 또다시 구현해서는 안 된다. 

**기존 해결책을 무시하고 자기가 다시 작성하는 대신 이미 구현된 코드를 재사용하면 좋은 이유**

- 시간과 노력을 절약한다.
- 버그 가능성을 줄여준다.
- 기존 전문지식을 활용한다.
- 코드가 이해하기 쉽다.

어떤 하위 문제를 해결하기 위해

-> 다른 개발자가 이미 코드를 작성했다면, 그것을 해결하기 위해 자신의 코드를 작성하기 보다 그들의 코드를 사용해야 한다.

-> 자신이 이미 코드를 작성했다면, 다른 개발자들이 동일한 문제를 해결하기 위해 자신만의 코드를 다시 작성하지 않도록 쉽게 재사용할 수 있는 방식으로 코드를 구성해야 한다.


## 고품질 코드 작성을 위한 높은 수준에서의 여섯 가지 전략


### 1. 코드는 읽기 쉬워야 한다.

코드를 읽을 때 이해하고자 하는 사항
- 코드가 하는 일
- 어떻게 그 일을 수행하는지
- (입력이나 상태 등) 어떤 것을 필요로 하는지
- 코드 실행 결과물

소프트웨어가 수행하는 모든 일은 그것을 가능하게 하는 어떤 코드에 의해 일어난다.

**그 코드가 무엇을 하는지 개발자가 이해하지 못하면, 소프트웨어 전체가 제대로 작동하는 것은 거의 불가능에 가깝다.**


### 2. 코드는 예측 가능해야 한다.

우리의 코드를 사용하는 다른 개발자는 이름, 데이터 유형, 일반적인 관행과 같은 단서를 사용해

**코드가 입력값으로 무엇을 예상하는지,**

**코드가 무슨 일을 하는지,**

**코드가 무엇을 반환하는지에 대한 정신 모델을 구축한다!**

이 정신 모델과 어긋나는 어떤 일이 코드에서 일어나면, 이로 인해 버그가 아무도 모르게 코드 내로 유입되는 일이 너무도 많이 일어난다.

**코드가 예상을 벗어나는 일을 수행하지 않는지 주의 깊게 살피고, 할 수 있다면 그런 코드를 작성하지 않도록 노력해야 한다.**


### 3. 코드는 오용하기 어렵게 만들라.

자신이 작성한 코드가 호출된 데는 이유가 있는데, 그 코드가 잘못 사용된다면 

중요한 일이 수행되지 않거나, 이상하게 동작하지만 눈에 띄지 않는다는 것을 의미할 수도 있다.

**코드를 오용하기 어렵거나 불가능하게 하면 코드가 작동할 뿐만 아니라 계속해서 잘 작동할 가능성을 극대화할 수 있다.**


### 4. 코드를 모듈화하라.

모듈화는 개체나 시스템의 구성 요소가 독립적으로 교환되어나 교체될 수 있음을 의미한다.

모듈화된 시스템의 주요 특징 중 하나는 인터페이스가 잘 정의되어 서로 다른 구성 요소 간 상호작용하는 지점이 최소화된다는 점이다.

코드를 외부에 의존하지 않고 실행할 수 있는 모듈로 나누는 것이 이로울 때가 많다.

인접한 모듈 사이의 상호작용은 한 곳에서 일어나고 잘 정의된 인터페이스를 사용한다.

이렇게 하면 변화하는 요구 사항에 더 쉽게 작응할 수 있는 코드를 작성하는 데 도움이 된다.

모듈화된 시스템은 일반적으로 이해하기 쉽고 추론하기 쉬운데, 기능이 관리 가능한 단위로 나누어지고 기능 단위 간 상호작용이 잘 정의되고 문서화되기 때문이다.

코드가 모듈화되어 작성되면 처음에 작동이 시작되고 그 후에도 계속해서 잘 작동할 가능성이 커진다. 왜냐하면 코드가 하는 일을 개발자들이 오해할 소지가 적기 때문이다.


### 5. 코드를 재사용 가능하고 일반화할 수 있게 작성하라.

- 재사용성 (reusability) : 어떤 문제를 해결하기 위한 무언가가 여러 가지 다른 상황에서도 사용될 수 있음을 의미
- 일반화성 (generalizability) : 개념적으로는 유사하지만 서로 미묘하게 다른 문제들을 해결할 수 있음을 의미

**코드가 재사용할 수 있고 일반화되어 있으면 우리는 그 코드를 여러 상황에서 재사용할 수 있고, 다양한 문제를 해결할 수 있다.**

**모듈화된 코드 역시 더 높은 재사용성과 일반화성을 가진다.**


### 6. 테스트가 용이한 코드를 작성하고, 제대로 테스트하라.

테스트는 두 가지 핵심 사항에 대한 주된 방어 수단이 될 때가 많다

1. 버그나 제대로 동작하지 않는 기능을 갖는 코드가 코드베이스에 병합되지 않도록 방지
2. 버그나 제대로 동작하지 않는 기능을 갖는 코드가 배포되지 않도록 막고 서비스 환경에서 실행되지 않도록 보장

#### 테스트를 작성하는 이유

**소프트웨어 시스템과 코드베이스는 너무 크고 복잡해 한 사람이 모든 세부 사항을 알 수 없고, 사람은 실수를 하는 존재이기 때문이다!!**


#### 테스트

- 단위 테스트 (unit test) : 일반적으로 개별 함수나 클래스와 같은 작은 단위의 코드를 테스트한다.
- 통합 테스트 (integration test) : 구성 요소와 하위 시스템을 함께 연결하는 과정을 통합이라고 한다. 통합 테스트를 통해 이러한 여러 구성 요소들이 제대로 작동하고 멈추는지를 테스트한다.
- 종단간 테스트 (end-to-end test) : 처음부터 끝까지 전체 소프트웨어 시스템에서 작동의 흐름 (또는 워크플로우)을 테스트한다.

#### 테스트 용이성 (testability)

테스트 대상이 되는 '살제'코드를 가리키며 해당 코드가 얼마나 테스트하기 접합한지를 나타낸다.

모듈화된 코드는 테스트 용이성이 더 좋다.

코드의 테스트 용이성이 낮으면 제대로 테스트하는 것이 불가능할 수 있다.

현재 작성중인 코드의 테스트 용이성을 확인하기 위해 코드를 작성하면서 '어떻게 테스트할 것인가?'를 계속 자문하는 것이 좋다.


## 고품질의 코드 작성이 어떻게 중장기적으로 시간과 노력을 절약할 수 있는지

단기적으로는 고품질 코드를 작성하는 데 시간이 더 걸릴 수 있다!

하지만 일반적으로 고품질 코드를 작성하는 것이 중장기적으로는 개발 시간을 단축해준다!


## 요약

- 좋은 소프트웨어를 만들려면 고품질 코드를 작성해야 한ㄷ.
- 실제 서비스 환경에서 실행되는 소프트웨어가 되기 전에 코드는 일반적으로 여러 단계의 검사와 테스트를 통과해야 한다.
- 버그나 제대로 동작하지 않는 기능이 사용자에게 제공되거나 비즈니스에 중요한 시스템에서 실행되는 것을 이러한 검사를 통해 막을 수 있다.
- 테스트는 코드를 작성하는 모든 단계에서 고려하는 것이 좋다. 코드를 다 작성하고 난 후에 고려하는 것이 아니다.
- 고품질 코드를 작성하면 처음에는 시간이 오래 걸리지만, 중장기적으로는 개발 시간이 단축되는 경우가 많다.